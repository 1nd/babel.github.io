---
layout: post
title:  "6.23.0 Released"
author: Henry Zhu
date:   2017-02-13 20:00:00
categories: announcements
share_text: "6.23.0"
---

Check out [GitHub](https://github.com/babel/babel/releases/tag/v6.23.0) for the whole changelog.

## üöÄ New Feature

### [#5236](https://github.com/babel/babel/pull/5236) Add option `throwIfClosureRequired` to `transform-es2015-block-scoping` to throw on slow code. ([@spicyj](https://github.com/spicyj))

```json
{
  "plugins": [
    ["transform-es2015-block-scoping", {
      "throwIfClosureRequired": true
    }]
  ]
}
```

In cases such as the following it's impossible to rewrite let/const without adding an additional function and closure while transforming:

```js
for (let i = 0; i < 5; i++) {
  setTimeout(() => console.log(i), 1);
}
```

In extremely performance-sensitive code, this can be undesirable. If `"throwIfClosureRequired": true` is set, Babel throws when transforming these patterns instead of automatically adding an additional function.

### [#4812](https://github.com/babel/babel/pull/4812) Support pure expressions in `transform-react-constant-elements` ([@STRML](https://github.com/STRML))

Adds a `path.isPure()` check to the plugin.

> The expression will remain in the hoisted code, even though it could be statically evaluated. UglifyJS/Babili will take care of that in many cases.

In

```
const OFFSET = 3;

var Foo = React.createClass({
  render: function () {
    return (
      <div tabIndex={OFFSET + 1} />
    );
  }
});
```

Out

```
const OFFSET = 3;

var _ref = <div tabIndex={OFFSET + 1} />;

var Foo = React.createClass({
  render: function () {
    return _ref;
  }
});
```

> Deopt

As noted in [facebook/react#3226](https://github.com/facebook/react/issues/3226), it's not safe to reuse elements with mutable props.

```
<div style={
  { width: 100 }
} />
```

### [#5288](https://github.com/babel/babel/pull/5288) Create `babel-preset-flow` ([@thejameskyle](https://github.com/thejameskyle))

> `babel-preset-flow` just includes `transform-flow-strip-types`.

> FYI: the React preset still includes the flow plugin by default (we might change it when TS support is added)

Before (still valid)

```js
{
  "plugins": ["transform-flow-strip-types"]
}
```

After

```js
{
  "presets": ["flow"]
}
```

> Thanks to [@simnalamburt](https://github.com/simnalamburt) for giving us the package name!

### [#5230](https://github.com/babel/babel/pull/5230) Add extra sibling methods to `babel-traverse`. ([@chitchu](https://github.com/chitchu))

There's already a `path.getSibling(number)`, so we're adding a few helper methods.

```js
path.getPrevSibling(); // path.getSibling(path.parentPath.key - 1)
path.getNextSibling(); // path.getSibling(path.parentPath.key + 1)
path.getAllPrevSiblings(); // returns Array<NodePath> of previous siblings
path.getAllNextSiblings();// returns Array<NodePath> of next siblings
```

## üêõ Bug Fixes

### [#5050](https://github.com/babel/babel/pull/5050) Rewrite `Hub` as an interface ([@yongxu](https://github.com/yongxu))

> This was reverted due to an incompatible change to babel-core

There are a few cases where `babel-traverse` can't be used standalone so this removes some code that tied `babel-traverse` to `babel-core`'s implementation.

### [#5298](https://github.com/babel/babel/pull/5298) Fix loose `transform-es2015-for-of` with label. ([@jridgewell](https://github.com/jridgewell))

```js
b: for (let c of d()) { // previously, label was completely dropped
  for (let e of f()) {
    continue b;
  }
}
```

### [#5153](https://github.com/babel/babel/pull/5153) Fixes to `babel-plugin-transform-react-constant-elements` ([@STRML](https://github.com/STRML))

Better hoisting inside variable declarations

```
function render() {
  const bar = "bar", renderFoo = () => <foo bar={bar} baz={baz} />, baz = "baz";

  return renderFoo();
}
```

```
function render() {
  const bar = "bar",
        renderFoo = () => _ref2,
        baz = "baz",
        _ref2 = <foo bar={bar} baz={baz} />;

  return renderFoo();
}
```

Hoisting with Higher Order Components

```
const HOC = component => component;

const Parent = () => (
  <div className="parent">
    <Child/>
  </div>
);

export default Parent;

let Child = () => (
  <div className="child">
    ChildTextContent
  </div>
);
Child = HOC(Child);
```

```
const HOC = component => component;

const Parent = () => _ref;

export default Parent;

var _ref2 = <div className="child">
    ChildTextContent
  </div>;

let Child = () => _ref2;
Child = HOC(Child);

var _ref = <div className="parent">
    <Child />
  </div>; 
```

### [#5143](https://github.com/babel/babel/pull/5143) Fix `PathHoister` hoisting JSX member expressions on `this` ([@STRML](https://github.com/STRML))

`<this.component />` was previously hoisted outside it's own function

```
function render() {
  this.component = "div";
  return () => <this.component />;
}
```


```
function render() {
  this.component = "div";

  var _ref = <this.component />;

  return () => _ref;
}
```

* `babel-plugin-transform-do-expressions`, `babel-traverse`
  * [#5030](https://github.com/babel/babel/pull/5030) Prevent multiple return statements in a loop when replacing expressions. ([@existentialism](https://github.com/existentialism))
* `babel-register`
  * [#5260](https://github.com/babel/babel/pull/5260) Fix TypeError with babel-register's cache. ([@xtuc](https://github.com/xtuc))
* `babel-traverse`
  * [#5206](https://github.com/babel/babel/pull/5206) Deopt evaluation of undefined with a local binding. Closes [#5204](https://github.com/babel/babel/issues/5204). ([@boopathi](https://github.com/boopathi))
* `babel-plugin-transform-runtime`
  * [#5195](https://github.com/babel/babel/pull/5195) Don't transpile ES7 symbol properties. ([@taion](https://github.com/taion))
* `babel`
  * [#5258](https://github.com/babel/babel/pull/5258) checks if babel is installed globally and displays correct cli message. ([@xtina-starr](https://github.com/xtina-starr))
* `babel-generator`
  * [#5270](https://github.com/babel/babel/pull/5270) Emit parens for await of ternary expressions. ([@erikdesjardins](https://github.com/erikdesjardins))
  * [#5193](https://github.com/babel/babel/pull/5193) Fix missing parens when function expressions is tag. ([@existentialism](https://github.com/existentialism))
* `babel-plugin-transform-es2015-modules-commonjs`
  * [#5235](https://github.com/babel/babel/pull/5235) Limit export node default assignment stack size #4323. ([@mattste](https://github.com/mattste))

## üè† Internal
* `babel-generator`
  * [#5255](https://github.com/babel/babel/pull/5255) codegen performance: use trim instead of lodash/trimEnd. ([@jwbay](https://github.com/jwbay))

---

## üåè Committers: 20

- Andres Suarez ([zertosh](https://github.com/zertosh))
- Ben Alpert ([spicyj](https://github.com/spicyj))
- Boopathi Rajaa ([boopathi](https://github.com/boopathi))
- Brian Ng ([existentialism](https://github.com/existentialism))
- Christina ([xtina-starr](https://github.com/xtina-starr))
- Erik Desjardins ([erikdesjardins](https://github.com/erikdesjardins))
- Fabian Finke ([finkef](https://github.com/finkef))
- Henry Zhu ([hzoo](https://github.com/hzoo))
- Jimmy Jia ([taion](https://github.com/taion))
- Justin Ridgewell ([jridgewell](https://github.com/jridgewell))
- Logan Smyth ([loganfsmyth](https://github.com/loganfsmyth))
- Matt Stewart ([mattste](https://github.com/mattste))
- Samuel Reed ([STRML](https://github.com/STRML))
- Sergey Rubanov ([chicoxyzzy](https://github.com/chicoxyzzy))
- Sven SAULEAU ([xtuc](https://github.com/xtuc))
- Vicente Jr Yuchitcho ([chitchu](https://github.com/chitchu))
- Yongxu Ren ([yongxu](https://github.com/yongxu))
- [jwbay](https://github.com/jwbay)
- james kyle ([thejameskyle](https://github.com/thejameskyle))
- ≈Åukasz Lity≈Ñski ([hex13](https://github.com/hex13))

Check out [Github](https://github.com/babel/babel/releases/tag/v6.23.0) for the whole changelog!
